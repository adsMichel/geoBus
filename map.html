<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #map {
            width: 100vw;
            height: 100vh;
            margin: 0;
            padding: 8px;
        }
        #map iframe {
            width: 100%;
            height: 100%;
            border: 0;
            display: block;
        }
    </style>
</head>
<body>
    <div id="map">
    </div>

    <!-- <script>
        navigator.geolocation.getCurrentPosition(position =>{
            const {latitude, longitude} = position.coords;
            console.log(latitude, longitude);
            
            // map.innerHTML = `<iframe width="600" height="450" src="https://maps.google.com/maps?q='+latitude+','+longitude+'&amp;z=15&amp;output=embed"></iframe>`;
            map.innerHTML = `<iframe src="https://maps.google.com/maps?q=${latitude},${longitude}&z=12&output=embed" height="500" width="600"></iframe>`;
        });
    </script> -->

    <!-- const DESTINATION_LAT = -15.8046849; // Latitude do local alvo -->
    <!-- const DESTINATION_LON = -48.0802278;  // Longitude do local alvo -->

    <script>
    // ===============================================
    // 1. CONFIGURA√á√ïES
    // ===============================================

    // Defina as coordenadas do local que voc√™ quer monitorar.
    const DESTINATION_LAT = -15.8046849; // Latitude do local alvo (Ex: Obelisco - SP)
    const DESTINATION_LON = -48.0802278;  // Longitude do local alvo
    
    // Raio de proximidade em metros.
    const PROXIMITY_RADIUS_METERS = 100; 

    // Fator de convers√£o (aproximado) de graus para metros
    const METERS_PER_DEGREE = 111000;


    // ===============================================
    // 2. FUN√á√ÉO DE C√ÅLCULO DE DIST√ÇNCIA
    // ===============================================

    function calculateApproximateDistance(lat1, lon1, lat2, lon2) {
        const dLat = lat2 - lat1;
        const dLon = lon2 - lon1;

        const dLatMeters = dLat * METERS_PER_DEGREE;
        const dLonMeters = dLon * METERS_PER_DEGREE * Math.cos(lat1 * Math.PI / 180);

        return Math.sqrt(dLatMeters * dLatMeters + dLonMeters * dLonMeters);
    }


    // ===============================================
    // 3. OBTEN√á√ÉO DA LOCALIZA√á√ÉO E VERIFICA√á√ÉO
    // ===============================================

    // Fun√ß√£o principal para obter a geolocaliza√ß√£o
    navigator.geolocation.getCurrentPosition(position => {
        const { latitude, longitude } = position.coords;
        console.log(`Posi√ß√£o Atual: Lat ${latitude}, Lon ${longitude}`);

        // Calcule a dist√¢ncia at√© o destino
        const distanceInMeters = calculateApproximateDistance(
            latitude,
            longitude,
            DESTINATION_LAT,
            DESTINATION_LON
        );

        console.log(`Dist√¢ncia at√© o destino: ${distanceInMeters.toFixed(2)} metros`);

        // VERIFICA√á√ÉO: Se a dist√¢ncia for menor ou igual ao raio, dispara o alerta.
        if (distanceInMeters <= PROXIMITY_RADIUS_METERS) {
            alert(`ü•≥ ALERTA DE PROXIMIDADE! Voc√™ est√° a APENAS ${distanceInMeters.toFixed(0)} metros do seu destino!`);
        } else {
            console.log("Voc√™ ainda est√° fora do raio de proximidade.");
        }

        // C√≥digo para atualizar o Iframe do mapa (requer um elemento <div id="map"> no HTML)
        const map = document.getElementById('map'); 
        if (map) {
             // üéØ URL CORRIGIDA: Usa o formato padr√£o de embed do Google Maps.
             const correctMapUrl = `https://maps.google.com/maps?q=${latitude},${longitude}&z=15&output=embed`;
             
             map.innerHTML = `<iframe 
                                 src="${correctMapUrl}" 
                                 height="500" 
                                 width="600" 
                                 style="border:0;" 
                                 loading="lazy" 
                                 allowfullscreen
                              ></iframe>`;
        }
    }, (error) => {
        // Fun√ß√£o de erro caso a geolocaliza√ß√£o falhe
        console.error("Erro ao obter a geolocaliza√ß√£o:", error);
    });
</script>

    
</body>
</html>